---
layout: default
---
<div class="hero">
  <h1>{{ page.title }}</h1>
  {% if page.summary %}<p>{{ page.summary }}</p>{% endif %}
  <div class="meta">
    {% if page.artist %}<span>By: {{ page.artist }}</span>{% endif %}
    {% if page.release_date %}<span>Released: {{ page.release_date | date: '%Y-%m-%d' }}</span>{% endif %}
    {% if page.project %}
      {% assign proj = site.projects | where: "slug", page.project | first %}
      <span>Project: <a href="{{ '/projects/' | append: page.project | append: '/' | relative_url }}">{{ proj.title }}</a></span>
    {% endif %}
  </div>
</div>

<div class="grid">
  <div class="card half">
    {% if page.cover %}
      <img src="{{ page.cover | relative_url }}" alt="{{ page.title }} cover" style="width:100%;border-radius:14px;border:1px solid var(--border);">
    {% else %}
      <p class="kicker">Cover art</p>
      <p>Add <code>cover:</code> to this album's front matter.</p>
    {% endif %}

    {% if page.listen_links %}
      <p class="kicker">Stream</p>
      <div class="tagrow">
        {% for l in page.listen_links %}
          <span class="tag"><a href="{{ l.url }}" target="_blank" rel="noopener">{{ l.label }}</a></span>
        {% endfor %}
      </div>
      <hr>
    {% endif %}
    <p class="kicker">Description / liner notes</p>
    {{ content }}
  </div>

  <div class="card half">
    <p class="kicker">Listen</p>
    {% if page.embed_html %}
      <div class="embed">{{ page.embed_html }}</div>
    {% else %}
      <p>Paste an embed iframe snippet into <code>embed_html:</code> in the front matter, or directly into the page body.</p>
    {% endif %}

    <hr>
    
    {% if page.download_links %}
      <p class="kicker">Download</p>              
        {% for l in page.download_links %}
          <span class="tag"><a href="{{ l.url }}" target="_blank" rel="noopener">{{ l.label }}</a></span>
          {% if l.comment %}
            {{ l.comment }}
            <BR>
            <BR>
          {% endif %}
        {% endfor %}
      <hr>
    {% endif %}
    
    <p class="kicker">Tracklist</p>
    <ol>
      {% assign tracks = site.tracks | where: 'album', page.slug | sort: 'track_number' %}
      {% for t in tracks %}
        <li>
          <a href="{{ t.url | relative_url }}"><strong>{{ t.title }}</strong></a>
          {% if t.duration %} - ({{ t.duration }}){% endif %} 
        </li>
      {% endfor %}
    </ol>
    
  </div>
  {% assign all_albums = site.albums | sort: "release_date" %}

  {% assign prev_album = nil %}
  {% assign next_album = nil %}

  {% for a in all_albums %}
    {% if a.url == page.url %}
      {% assign idx = forloop.index0 %}
      {% if idx > 0 %}
        {% assign prev_idx = idx | minus: 1 %}
        {% assign prev_album = all_albums[prev_idx] %}
      {% endif %}

      {% assign last_idx = all_albums.size | minus: 1 %}
      {% if idx < last_idx %}
        {% assign next_idx = idx | plus: 1 %}
        {% assign next_album = all_albums[next_idx] %}
      {% endif %}
    {% endif %}
  {% endfor %}

  {% if prev_album or next_album %}
    <div class="card album-nav-card">
      <div class="album-nav-row">
        <div class="album-nav-col album-nav-prev">
          {% if prev_album %}
            <a class="tag" href="{{ prev_album.url }}">← {{ prev_album.title }}</a>
          {% endif %}
        </div>

        <div class="album-nav-col album-nav-center">
          <a class="tag" href="/albums/">All albums</a>
        </div>

        <div class="album-nav-col album-nav-next">
          {% if next_album %}
            <a class="tag" href="{{ next_album.url }}">{{ next_album.title }} →</a>
          {% endif %}
        </div>
      </div>
    </div>
  {% endif %}
</div>
